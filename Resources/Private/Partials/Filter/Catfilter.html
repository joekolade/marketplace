<h2>
    {category.title}
</h2>

<!-- TODO: PageUid anpassen -->
<f:form object="{filter}" objectName="filter" name="filter" method="POST" action="catList" noCacheHash="1">
    <f:comment>
        <!-- Search field -->
        <div class="form-group has-feedback has-clear">
            <f:form.textfield class="form-control" property="searchphrase"
                              placeholder="{f:translate(key: 'tx_marketplace_domain_model_filter.searchphrase')}"/>
            <span class="fa fa-remove form-control-feedback form-control-clear" aria-hidden="true"></span>
            <span class="sr-only">Clear input content</span>
        </div>
    </f:comment>

    <f:groupedFor each="{options}" as="opts" groupBy="optionselect" groupKey="select">
        <f:comment>
            <f:render section="select" arguments="{select: select, options: opts, sub: '0'}"></f:render>
        </f:comment>
        {select.title}:<br>
        <f:for each="{opts}" as="option">
            <f:render section="options" arguments="{option: option}"></f:render>
        </f:for>
    </f:groupedFor>


    <!--
        TODO: Filter nach LÃ¤ndern
    -->

    <div class="panel panel-default">
        <div class="panel-heading" role="tab">
            <h4 class="panel-title">
                <a class="btn btn-block" data-toggle="collapse" href="#collapseProducer">
                    {f:translate(key: 'tx_marketplace_domain_model_filter.producer')}
                    <i class="fa fa-plus"></i>
                </a>
            </h4>
        </div>
        <div id="collapseProducer" class="panel-collapse collapse{f:if(condition: filter.producer, then: ' in')}" role="tabpanel">
            <div class="panel-body">
                <f:form.select property="producer" multiple="TRUE" options="{producers}" optionValueField="uid" optionLabelField="name" class="form-control selectpicker show-tick" data="{live-search: 'true', selected-text-format: 'count'}"></f:form.select>
            </div>
        </div>
    </div>
    <div class="function">
        <f:if condition="{filterActive}">
            <f:link.action action="ratinglist" class="btn btn-default btn-reset pull-right">
                {f:translate(key: 'productList.resetButton')}
                <i class="fa fa-times-circle"></i>
            </f:link.action>
        </f:if>

        <button type="submit" class="btn btn-warning btn-search">
            {f:translate(key: 'productList.filterButton')}
            <i class="fa fa-search"></i>
        </button>
    </div>
    <!-- Sorting (ausgestellt) -->
    <f:alias map="{sortbyArray: {0: '{f:translate(key: \'productList.filter.sortby.0\')}', 1: '{f:translate(key: \'productList.filter.sortby.1\')}', 2: '{f:translate(key: \'productList.filter.sortby.2\')}', 3: '{f:translate(key: \'productList.filter.sortby.3\')}', 4: '{f:translate(key: \'productList.filter.sortby.4\')}', 5: '{f:translate(key: \'productList.filter.sortby.5\')}', 6: '{f:translate(key: \'productList.filter.sortby.6\')}', 7: '{f:translate(key: \'productList.filter.sortby.7\')}'}}">
        <div class="sortby-select form-inline">
            <div class="form-group">
                <f:translate key="productList.filter.sortbyLabel">Sort by</f:translate>
                <f:form.select class="form-control selectpicker" property="sortby" options="{sortbyArray}" />
            </div>
        </div>
    </f:alias>

</f:form>

<f:section name="select">
    <f:if condition="{sub}">
        <f:then>
            <b>{select.output}</b>
            <br>
            <f:for each="{opts}" as="option">
                <f:render section="options" arguments="{option: option}"></f:render>
            </f:for>
        </f:then>
        <f:else>
            <div class="panel panel-default">
                <div class="panel-heading" role="tab">
                    <h4>
                        <a class="btn btn-block" data-toggle="collapse" href="#collapse-select-{select.uid}">
                            {select.output}
                            <i class="fa fa-plus"></i>
                        </a>
                    </h4>
                </div>
                <div id="collapse-select-{select.uid}" class="panel-collapse collapse in" role="tabpanel">
                    <div class="panel-body">
                        <f:if condition="{select.options -> f:count()} > 0">
                            <f:then>
                                <f:for each="{select.options}" as="option">
                                    <f:render section="options" arguments="{option: option, sub: 'true'}"></f:render>
                                </f:for>
                            </f:then>
                            <f:else>
                                <f:for each="{select.selects}" as="select2">
                                    <f:render section="select"
                                              arguments="{select: select2, sub: 'true'}"></f:render>
                                </f:for>
                            </f:else>
                        </f:if>
                    </div>
                </div>
            </div>
        </f:else>

    </f:if>

</f:section>

<f:section name="options">
    <div class="checkbox">
        <label for="option-{option.uid}">
            <f:form.checkbox property="options" id="option-{option.uid}"
                             value="{option.uid}"/>
            {option.title}
        </label>
    </div>
</f:section>